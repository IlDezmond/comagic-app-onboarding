### Интеграция с Bukza
<br />

**Ценность**<br />  

Решение позволяет настроить передачу заявок, оформленных через виджет онлайн-записи Bukza в CoMagic для дальнейшего анализа эффективности рекламы.<br />

 **Какие данные передаются**    
- контактные данные (имя,телефон,email);
- дату и время создания;
- данные сессии (рекламную кампанию, источник, UTM-метки и тд);
- в случае отсутствия сессии, дефолтную РК или источник.  <br />


**Настройка интеграции**  
1. Нажмите "Активен" на этой странице.
2. Настройте Webhook в Bukza <br />

<details>
 <summary style="font-weight:bold;"> Подробнее </summary>  <br />

- Шаблоны и интеграции → Веб-запросы → Создать веб-запрос
  - указываем название;
  - в URL указываем Webhook url из настроек интеграции;
  - проставляем галочку POST запрос и в тело добавляем следующий json;  <br />
  
    <Alert backgroundColor="#c3e8d7">
     
     {  
     "date_time": "[bukza_created_date]",  
     "name": "[bukza_full_name]",  
     "phone": "[bukza_phone]",  
     "email": "[bukza_email]",  
     "message": "Номер заказа: [bukza_order_id]; Код бронирования: [bukza_code]",  
     "visitor_session_id": "[bukza_n2]"  
     } 
     
    </Alert>   
    <br />

   - сохраняем.
    
   <br />

- Триггеры → Добавить задачу 
  - добавляем действие "Отправить веб-запрос" и выбираем созданный ранее веб-запрос;
  - "если в заказе несколько бронирований?" выбираем Выполнить для каждого;
  - сохраняем. 

![image](bukza_hook.gif)
 
</details>  
<br />

3. **ID виджета** — у каждого виджета в Bukza уникальный id . Необходимо добавить список всех виджетов, с которыми требуется подключить интеграцию.   
ID можно взять из кода виджета. 

![image](bukza_widgets.gif)
<br />

4. **Тип трафика** — необходимо выбрать какую сущность использовать для обращений без сессии. <br />  
В зависимости от выбранного **типа трафика** выводится либо список источников и сайтов  из личного кабинета клиента, либо список рекламных кампаний. Необходимо указать какой **источник и сайт/рекламную кампанию** используем в случае отсутствия сессии.

<br /> 

5. Нажмите сохранить.
6. После сохранения будет выведен скрипт, который необходимо установить на сайт в соответствие с описанием в настройках.

![image](bukza2.png)
<br />

После подключения интеграции записи будут попадать в наши отчеты с типом "Заявки". <br /> 
Для проверки корректности работы интеграции оставьте тестовое обращение в форме онлайн-записи Bukza на сайте.<br />
