### Интеграция с RetailCRM <br />

**Ценность** <br />

Решение позволяет передавать в наш кабинет данные по сделкам, для дальнейшего построения Сквозной аналитики, а также интегрировать функционал телефонии и передавать данные по звонкам в RetailCRM. <br /> 

**Какие данные передаются** <br />

Данные получаемые по сделкам:    <br />
- сделки: сумма сделки, статус, магазин, к которому относится сделка и тд; 
- воронка продаж и ее этапы;
- контакты;
- ответственный менеджер.   <br />

Данные передаваемые по звонкам:  <br />

- всплывающие уведомления о входящих звонках;
- звонок в один клик из RetailCRM;
- сохранение истории и записей звонков в RetailCRM. <br />

<br />
<br />
<br />
<br />

## Подключение передачи сделок   <br />


<details>
 <summary style="font-weight:bold;"> Шаги по подключению </summary> <br />

1. Прожмите переключатель "RetailCRM - передача сделок", для активации интеграции. <br />
2. Добавьте данные для **Авторизации** в настройках интеграции  <br />

<details>
  <summary style="font-weight:bold;"> Подробнее </summary> <br />
 
Добавьте:
- URL (домен RetailCRM ) в формате https://shop472.retailcrm.ru/ , часть 'shop472' у каждого клиента уникальна
- API key - ключ API RetailCRM, Настройки - > Интеграция → Ключи доступа к API -> Добавить
Создаем новый ключ, с доступом ко всем магазинам и методам. Добавляем данный ключ в настройки интеграции.

![image](retailcrm_auth.gif)

</details> 
<br />

3. **Настройте Триггер в RetailCRM** <br />

<details>
  <summary style="font-weight:bold;"> Подробнее </summary> <br />

Автоматизация → Триггеры →  Добавить триггер <br />
Заполните настройки триггера:

- название ;
- добавляем событие 'Изменение заказа ': 
  - обязательно указываем в условиях:  "Новый заказ" или  "Изменение статуса заказа с Любой на Любой" или "Заказ оплачен "Да";
  - в действие добавляем "Выполнить HTTP-запрос"  , в нем заполняем настройки :
     - Адрес  - Webhook url из настроек интеграции;
     - HTTP метод - GET;
     - Передавать параметры - в строке запроса; 
        - Параметр: orderId 
        - Значение: {{ order.id }} <br />

![image](retail_trigger_3.gif)

</details> 

<br />
 
4. Проставьте требуемые настройки: <br />
- **Дефолтная воронка** — при прожатии все сделки будут передаваться в 1 воронку по умолчанию. В противном случае по каждом магазину будет создана отдельная воронка. <br />
- **Учитывать стоимость доставки** — при прожатии в сумму сделки будет включена стоимость доставки. <br />

5. Нажмите сохранить. <br />


После подключения интеграции сделки будут попадать в  Сырые данные -> Сделки.  <br />
Для проверки корректности работы интеграции создайте тестовую сделку в RetailCRM.

</details> 


<br />
<br />
<br />
<br />
<br />
<br />
<br />

## Подключение телефонии   <br />

<details>
 <summary style="font-weight:bold;"> Шаги по подключению </summary> <br />
  
1. Прожмите переключатель "RetailCRM - телефония", для активации интеграции. <br />
2. Добавьте данные для авторизации в настройках интеграции <br />

<details>
  <summary style="font-weight:bold;"> Подробнее </summary> <br />
 
Добавьте:
- URL (домен RetailCRM ) в формате https://shop472.retailcrm.ru/ , часть 'shop472' у каждого клиента уникальна
- API key - ключ API RetailCRM, Настройки - > Интеграция → Ключи доступа к API -> Добавить
Создаем новый ключ, с доступом ко всем магазинам и методам. Добавляем данный ключ в настройки интеграции.

![image](retailcrm_auth.gif)

</details> 
<br />

3. **Добавочные коды сотрудников** - укажите соответствие сотрудников из RetailCRM и их добавочных кодов, заданных в нашем кабинете (внутренние номера).  <br />
4. **Внешние номера магазинов** - укажите соответствие магазинов из RetailCRM и их внешних номеров (виртуальные номера). <br />
5. Нажмите сохранить. <br />

При подключении интеграции в нашем ЛК, автоматически подключается приложение в Маркетплейсе в RetailCRM.<br />
Для проверки работы интеграции на тестовых звонках проверьте работу пунктов указаных в **"Данные передаваемые по звонкам"**. <br />


</details> 

